# Turtle Trading Bot Environment Configuration
# Copy this file to .env and update with your values

# =============================================================================
# INTERACTIVE BROKERS CONFIGURATION (Primary Data Source)
# =============================================================================

# TWS/Gateway connection settings
IBKR_HOST=127.0.0.1
IBKR_PORT=7497                    # 7497=TWS Paper, 7496=TWS Live, 4002=Gateway Paper, 4001=Gateway Live
IBKR_CLIENT_ID=1                  # Unique client ID for this connection

# Account settings
IBKR_ACCOUNT_ID=DUP318628         # Your IB account ID (paper or live)

# Timeouts (seconds)
IBKR_CONNECTION_TIMEOUT=30
IBKR_REQUEST_TIMEOUT=60

# Data settings
IBKR_USE_RTH=true                 # true = Regular Trading Hours only

# Retry settings
IBKR_MAX_RETRIES=3
IBKR_RETRY_DELAY=2.0              # Seconds between retries

# =============================================================================
# YAHOO FINANCE CONFIGURATION (Backup Data Source)
# =============================================================================

YAHOO_REQUESTS_PER_MINUTE=60      # Rate limiting
YAHOO_AUTO_ADJUST=true            # Auto-adjust for splits/dividends

# =============================================================================
# DATA SOURCE CONFIGURATION
# =============================================================================

DATA_PRIMARY_SOURCE=ibkr          # Primary data source (ibkr or yahoo)
DATA_ENABLE_FALLBACK=true         # Fall back to Yahoo if IBKR fails
DATA_VALIDATE_AGAINST_SECONDARY=false  # Cross-check data between sources
DATA_MAX_PRICE_DEVIATION_PCT=2.0  # Max allowed deviation between sources

# =============================================================================
# DATABASE CONFIGURATION (Neon PostgreSQL - Cloud)
# =============================================================================

# Neon PostgreSQL connection string
DATABASE_URL=postgresql://neondb_owner:npg_ipM4O8DGaeBP@ep-autumn-morning-afn6oh1a-pooler.c-2.us-west-2.aws.neon.tech/neondb?sslmode=require
DATABASE_POOL_SIZE=5

# =============================================================================
# CACHING CONFIGURATION
# =============================================================================

# Redis deferred - using in-memory caching for now
# REDIS_URL=redis://localhost:6379/0
CACHE_TTL_SECONDS=5               # Seconds to cache prices in memory

# =============================================================================
# TRADING CONFIGURATION
# =============================================================================

# Risk settings
RISK_PER_TRADE=0.02               # 2% per trade (original Turtle rule)
# RISK_PER_TRADE=0.005            # 0.5% per trade (modern Parker rule for 300+ markets)

# Position limits
MAX_UNITS_PER_MARKET=4
MAX_UNITS_CORRELATED=6
MAX_UNITS_TOTAL=12

# Drawdown settings
DRAWDOWN_REDUCTION_THRESHOLD=0.10  # 10% drawdown triggers reduction
DRAWDOWN_EQUITY_REDUCTION=0.20     # Reduce notional equity by 20%

# =============================================================================
# AI INTEGRATION (Optional)
# =============================================================================

# GEMINI_API_KEY=your_gemini_api_key_here
# LANGCHAIN_API_KEY=your_langchain_api_key_here

# =============================================================================
# LOGGING
# =============================================================================

LOG_LEVEL=INFO
LOG_FORMAT=json                    # json or text

# =============================================================================
# DOCKER DEPLOYMENT
# =============================================================================

# Trading mode: paper or live
TRADING_MODE=paper

# Dry run mode (true = simulate, no real orders)
DRY_RUN=true

# Monitoring check interval in seconds
CHECK_INTERVAL_SECONDS=60

# Timezone (for market hours)
TZ=America/New_York

# For Docker: use host.docker.internal to connect to TWS on host
# IBKR_HOST=host.docker.internal
